{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from \"axios\";\nimport LayoutDiv from \"../LayoutDiv.vue\";\nexport default {\n  name: \"DashboardPage\",\n  components: {\n    LayoutDiv\n  },\n  data() {\n    return {\n      user: {},\n      results: [],\n      rows: [],\n      keys: [],\n      search: '',\n      filter: '',\n      submitted: '',\n      name: [],\n      purchase_record: {},\n      tracking_record: [],\n      tracking_keys: [],\n      filter_purchase: ''\n    };\n  },\n  created() {\n    this.load_book_list();\n    this.name = localStorage.getItem(\"name\");\n    this.show_purchase_record();\n  },\n  methods: {\n    logoutAction() {\n      localStorage.setItem(\"token\", \"\");\n      this.$router.push(\"/\");\n    },\n    load_book_list() {\n      axios.get(\"http://127.0.0.1:5000/book_list\").then(r => {\n        this.results = r.data;\n        for (var i = 0; i < r.data.length; i++) {\n          this.rows.push(i);\n        }\n        this.keys = Object.keys(this.results[0]);\n        // console.log(this.keys);\n      }).catch(e => {\n        return e;\n      });\n    },\n    submit_record() {\n      this.purchase_record.name = this.name;\n      this.purchase_record.title = this.filteredRows[0].title;\n      this.purchase_record.price = this.filteredRows[0].price;\n      console.log(this.purchase_record);\n      axios.post(\"http://127.0.0.1:5000/buy_new_book\", this.purchase_record).then(response => {\n        console.log(response.data);\n        this.show_purchase_record();\n      }).catch(error => {\n        console.log(error);\n      });\n    },\n    show_purchase_record() {\n      var post = {\n        'name': this.name\n      };\n      axios.post(\"http://127.0.0.1:5000/show_user_purchase_record\", post).then(response => {\n        console.log(response.data);\n        this.tracking_record = response.data;\n        this.tracking_keys = Object.keys(this.tracking_record[0]);\n        console.log(this.tracking_keys);\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n  },\n  computed: {\n    filteredRows() {\n      return this.results.filter(row => {\n        const title = row.title.toString();\n        const categories = row.categories;\n        const authors = row.authors.toString();\n        const ratings = row.ratings;\n        const price = row.price.toString();\n        const searchTerm = this.filter;\n        return title.includes(searchTerm) || categories.includes(searchTerm) || authors.includes(searchTerm) || ratings.includes(searchTerm) || price.includes(searchTerm);\n      });\n    },\n    filteredpurchaserecord() {\n      return this.tracking_record.filter(row => {\n        const trackingname = row.name.toString();\n        const trackingtitle = row.title.toString();\n        const trackingsearchTerm = this.filter_purchase;\n        return trackingtitle.includes(trackingsearchTerm) || trackingname.includes(trackingsearchTerm);\n      });\n    }\n  }\n};","map":{"version":3,"names":["axios","LayoutDiv","name","components","data","user","results","rows","keys","search","filter","submitted","purchase_record","tracking_record","tracking_keys","filter_purchase","created","load_book_list","localStorage","getItem","show_purchase_record","methods","logoutAction","setItem","$router","push","get","then","r","i","length","Object","catch","e","submit_record","title","filteredRows","price","console","log","post","response","error","computed","row","toString","categories","authors","ratings","searchTerm","includes","filteredpurchaserecord","trackingname","trackingtitle","trackingsearchTerm"],"sources":["/Users/waiwai/Desktop/Vuejs/model-project/src/components/pages/DashboardPage.vue"],"sourcesContent":["<template>\n  <layout-div>\n    <div class=\"row justify-content-md-center\">\n      <div class=\"col-12\">\n        <nav class=\"navbar navbar-expand-lg navbar-light bg-light\">\n          <div class=\"container-fluid\">\n            <a class=\"navbar-brand\" href=\"#\">Purchase system</a>\n            <div class=\"d-flex\">\n              <ul class=\"navbar-nav\">\n                <li class=\"nav-item\">\n                  <a @click=\"logoutAction()\" class=\"nav-link\" aria-current=\"page\" href=\"#\">Logout</a>\n                </li>\n              </ul>\n            </div>\n          </div>\n        </nav>\n        <h2 class=\"text-left mt-2\">User name: {{ this.name }}</h2>\n        <div id=\"app\">\n          <table>\n            <thead>\n              <tr>\n                <th v-for=\"col in keys\" :key=\"col\">{{ col }}</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"(row, index) in filteredRows\" :key=\"index\">\n                <td v-html=\"row.title\"></td>\n                <td v-html=\"row.categories\"></td>\n                <td v-html=\"row.authors\"></td>\n                <td v-html=\"row.ratings\"></td>\n                <td v-html=\"row.price\"></td>\n              </tr>\n            </tbody>\n          </table>\n          <input type=\"text\" placeholder=\"Filter by title or categories\" v-model=\"filter\" />\n        </div>\n        <div>\n          <button @click=\"submit_record\">Submit</button>\n          <tr>{{submitted}}</tr>\n        </div>\n        <br/>\n        <div>\n\n        </div>\n        <div id=\"app\">\n          <table>\n            <thead>\n              <tr>\n                <th v-for=\"col in this.tracking_keys\" :key=\"col\">{{ col }}</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"(row, index) in this.filteredpurchaserecord\" :key=\"index\">\n                <td v-html=\"row.record_number\"></td>\n                <td v-html=\"row.name\"></td>\n                <td v-html=\"row.title\"></td>\n                <td v-html=\"row.price\"></td>\n              </tr>\n            </tbody>\n          </table>\n          <input type=\"text\" placeholder=\"Filter by title or categories\" v-model=\"filter_purchase\" />\n        </div>\n        <div>\n          <!-- <button @click=\"submit_record\">Delete record</button> -->\n          <tr>{{submitted}}</tr>\n        </div>\n      </div>\n    </div>\n  </layout-div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport LayoutDiv from \"../LayoutDiv.vue\";\n\nexport default {\n  name: \"DashboardPage\",\n  components: {\n    LayoutDiv\n  },\n  data() {\n    return {\n      user: {},\n      results: [],\n      rows: [],\n      keys: [],\n      search: '',\n      filter: '',\n      submitted: '',\n      name: [],\n      purchase_record: {},\n      tracking_record : [],\n      tracking_keys: [],\n      filter_purchase: ''\n    };\n  },\n  created() {\n    this.load_book_list();\n    this.name = localStorage.getItem(\"name\");\n    this.show_purchase_record();\n  },\n  methods: {\n\n    logoutAction() {\n      localStorage.setItem(\"token\", \"\");\n      this.$router.push(\"/\");\n    },\n    load_book_list() {\n      axios\n        .get(\"http://127.0.0.1:5000/book_list\")\n        .then((r) => {\n          this.results = r.data;\n          for (var i = 0; i < r.data.length; i++) {\n            this.rows.push(i);\n          }\n          this.keys = Object.keys(this.results[0]);\n          // console.log(this.keys);\n        })\n        .catch((e) => {\n          return e;\n        });\n    },\n    submit_record() {\n      this.purchase_record.name = this.name\n      this.purchase_record.title = this.filteredRows[0].title\n      this.purchase_record.price = this.filteredRows[0].price\n      console.log(this.purchase_record)\n      axios\n        .post(\"http://127.0.0.1:5000/buy_new_book\", this.purchase_record)\n        .then((response) => {\n            console.log(response.data)\n            this.show_purchase_record();\n        })\n        .catch((error) => {\n          console.log(error);\n        });\n    },\n    show_purchase_record(){\n      var post = {'name':this.name}\n      axios\n        .post(\"http://127.0.0.1:5000/show_user_purchase_record\", post)\n        .then((response) => {\n            console.log(response.data)\n            this.tracking_record = response.data\n            this.tracking_keys = Object.keys(this.tracking_record[0]);\n            console.log(this.tracking_keys)\n        })\n        .catch((error) => {\n          console.log(error);\n        });\n    }\n\n  },\n  computed: {\n    filteredRows() {\n      return this.results.filter(row => {\n        const title = row.title.toString();\n        const categories = row.categories;\n        const authors = row.authors.toString();\n        const ratings = row.ratings;\n        const price = row.price.toString();\n        const searchTerm = this.filter;\n        return (\n          title.includes(searchTerm) || categories.includes(searchTerm) ||\n          authors.includes(searchTerm) || ratings.includes(searchTerm) ||\n          price.includes(searchTerm)\n        );\n      });\n    },\n    filteredpurchaserecord(){\n      return this.tracking_record.filter(row => {\n        const trackingname = row.name.toString();\n        const trackingtitle = row.title.toString();\n        const trackingsearchTerm = this.filter_purchase;\n        return (\n          trackingtitle.includes(trackingsearchTerm) || trackingname.includes(trackingsearchTerm)\n        );\n      });\n    }\n  }\n}\n\n</script>\n\n<style scoped>\ntable {\n  font-family: arial, sans-serif;\n  border-collapse: collapse;\n  width: 100%;\n}\n\ntd,\nth {\n  border: 1px solid #dddddd;\n  text-align: left;\n  padding: 8px;\n}\n\nth {\n  background-color: #dddddd;\n}\n\ninput[type=text],\nselect {\n  width: 100%;\n  padding: 12px 20px;\n  margin: 8px 0;\n  display: inline-block;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  box-sizing: border-box;\n  margin-top: 25px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}