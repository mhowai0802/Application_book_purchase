{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelText as _vModelText, withDirectives as _withDirectives, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-aff77390\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"row justify-content-md-center\"\n};\nconst _hoisted_2 = {\n  class: \"col-12\"\n};\nconst _hoisted_3 = {\n  class: \"navbar navbar-expand-lg navbar-light bg-light\"\n};\nconst _hoisted_4 = {\n  class: \"container-fluid\"\n};\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"a\", {\n  class: \"navbar-brand\",\n  href: \"#\"\n}, \"Purchase system\", -1 /* HOISTED */));\nconst _hoisted_6 = {\n  class: \"d-flex\"\n};\nconst _hoisted_7 = {\n  class: \"navbar-nav\"\n};\nconst _hoisted_8 = {\n  class: \"nav-item\"\n};\nconst _hoisted_9 = {\n  class: \"text-left mt-2\"\n};\nconst _hoisted_10 = {\n  id: \"app\"\n};\nconst _hoisted_11 = [\"innerHTML\"];\nconst _hoisted_12 = [\"innerHTML\"];\nconst _hoisted_13 = [\"innerHTML\"];\nconst _hoisted_14 = [\"innerHTML\"];\nconst _hoisted_15 = [\"innerHTML\"];\nconst _hoisted_16 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1 /* HOISTED */));\nconst _hoisted_17 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", null, null, -1 /* HOISTED */));\nconst _hoisted_18 = {\n  id: \"app\"\n};\nconst _hoisted_19 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1 /* HOISTED */));\nconst _hoisted_20 = {\n  class: \"text-left mt-2\"\n};\nconst _hoisted_21 = [\"innerHTML\"];\nconst _hoisted_22 = [\"innerHTML\"];\nconst _hoisted_23 = [\"innerHTML\"];\nconst _hoisted_24 = [\"innerHTML\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_layout_div = _resolveComponent(\"layout-div\");\n  return _openBlock(), _createBlock(_component_layout_div, null, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"nav\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_hoisted_5, _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"ul\", _hoisted_7, [_createElementVNode(\"li\", _hoisted_8, [_createElementVNode(\"a\", {\n      onClick: _cache[0] || (_cache[0] = $event => $options.logoutAction()),\n      class: \"nav-link\",\n      \"aria-current\": \"page\",\n      href: \"#\"\n    }, \"Logout\")])])])])]), _createElementVNode(\"h2\", _hoisted_9, \"User name: \" + _toDisplayString(this.name), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"table\", null, [_createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.keys, col => {\n      return _openBlock(), _createElementBlock(\"th\", {\n        key: col\n      }, _toDisplayString(col), 1 /* TEXT */);\n    }), 128 /* KEYED_FRAGMENT */))])]), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($options.filteredRows, (row, index) => {\n      return _openBlock(), _createElementBlock(\"tr\", {\n        key: index\n      }, [_createElementVNode(\"td\", {\n        innerHTML: row.title\n      }, null, 8 /* PROPS */, _hoisted_11), _createElementVNode(\"td\", {\n        innerHTML: row.categories\n      }, null, 8 /* PROPS */, _hoisted_12), _createElementVNode(\"td\", {\n        innerHTML: row.authors\n      }, null, 8 /* PROPS */, _hoisted_13), _createElementVNode(\"td\", {\n        innerHTML: row.ratings\n      }, null, 8 /* PROPS */, _hoisted_14), _createElementVNode(\"td\", {\n        innerHTML: row.price\n      }, null, 8 /* PROPS */, _hoisted_15)]);\n    }), 128 /* KEYED_FRAGMENT */))])]), _withDirectives(_createElementVNode(\"input\", {\n      type: \"text\",\n      placeholder: \"Filter by title or categories\",\n      \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.filter = $event)\n    }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.filter]])]), _createElementVNode(\"div\", null, [_createElementVNode(\"button\", {\n      onClick: _cache[2] || (_cache[2] = (...args) => $options.submit_record && $options.submit_record(...args))\n    }, \"Submit\"), _createElementVNode(\"tr\", null, _toDisplayString($data.submitted), 1 /* TEXT */)]), _hoisted_16, _hoisted_17, _createElementVNode(\"div\", _hoisted_18, [_hoisted_19, _createElementVNode(\"h2\", _hoisted_20, \"User name: \" + _toDisplayString(this.name), 1 /* TEXT */), _createElementVNode(\"table\", null, [_createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(this.tracking_keys, col => {\n      return _openBlock(), _createElementBlock(\"th\", {\n        key: col\n      }, _toDisplayString(col), 1 /* TEXT */);\n    }), 128 /* KEYED_FRAGMENT */))])]), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(this.filteredpurchaserecord, (row, index) => {\n      return _openBlock(), _createElementBlock(\"tr\", {\n        key: index\n      }, [_createElementVNode(\"td\", {\n        innerHTML: row.record_number\n      }, null, 8 /* PROPS */, _hoisted_21), _createElementVNode(\"td\", {\n        innerHTML: row.name\n      }, null, 8 /* PROPS */, _hoisted_22), _createElementVNode(\"td\", {\n        innerHTML: row.title\n      }, null, 8 /* PROPS */, _hoisted_23), _createElementVNode(\"td\", {\n        innerHTML: row.price\n      }, null, 8 /* PROPS */, _hoisted_24)]);\n    }), 128 /* KEYED_FRAGMENT */))])]), _withDirectives(_createElementVNode(\"input\", {\n      type: \"text\",\n      placeholder: \"Filter by title or categories\",\n      \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $data.filter_purchase = $event)\n    }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.filter_purchase]])]), _createElementVNode(\"div\", null, [_createCommentVNode(\" <button @click=\\\"submit_record\\\">Delete record</button> \"), _createElementVNode(\"tr\", null, _toDisplayString($data.submitted), 1 /* TEXT */)])])])]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["class","_createElementVNode","href","id","_createBlock","_component_layout_div","default","_withCtx","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","onClick","_cache","$event","$options","logoutAction","_hoisted_9","_toDisplayString","name","_hoisted_10","_createElementBlock","_Fragment","_renderList","$data","keys","col","key","filteredRows","row","index","innerHTML","title","_hoisted_11","categories","_hoisted_12","authors","_hoisted_13","ratings","_hoisted_14","price","_hoisted_15","type","placeholder","filter","args","submit_record","submitted","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","tracking_keys","filteredpurchaserecord","record_number","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","filter_purchase","_createCommentVNode","_"],"sources":["/Users/waiwai/Desktop/Vuejs/model-project/src/components/pages/DashboardPage.vue"],"sourcesContent":["<template>\n  <layout-div>\n    <div class=\"row justify-content-md-center\">\n      <div class=\"col-12\">\n        <nav class=\"navbar navbar-expand-lg navbar-light bg-light\">\n          <div class=\"container-fluid\">\n            <a class=\"navbar-brand\" href=\"#\">Purchase system</a>\n            <div class=\"d-flex\">\n              <ul class=\"navbar-nav\">\n                <li class=\"nav-item\">\n                  <a @click=\"logoutAction()\" class=\"nav-link\" aria-current=\"page\" href=\"#\">Logout</a>\n                </li>\n              </ul>\n            </div>\n          </div>\n        </nav>\n        <h2 class=\"text-left mt-2\">User name: {{ this.name }}</h2>\n        <div id=\"app\">\n          <table>\n            <thead>\n              <tr>\n                <th v-for=\"col in keys\" :key=\"col\">{{ col }}</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"(row, index) in filteredRows\" :key=\"index\">\n                <td v-html=\"row.title\"></td>\n                <td v-html=\"row.categories\"></td>\n                <td v-html=\"row.authors\"></td>\n                <td v-html=\"row.ratings\"></td>\n                <td v-html=\"row.price\"></td>\n              </tr>\n            </tbody>\n          </table>\n          <input type=\"text\" placeholder=\"Filter by title or categories\" v-model=\"filter\" />\n        </div>\n        <div>\n          <button @click=\"submit_record\">Submit</button>\n          <tr>{{submitted}}</tr>\n        </div>\n        <br/>\n        <div>\n\n        </div>\n        <div id=\"app\">\n          <br/>\n          <h2 class=\"text-left mt-2\">User name: {{ this.name }}</h2>\n\n          <table>\n            <thead>\n              <tr>\n                <th v-for=\"col in this.tracking_keys\" :key=\"col\">{{ col }}</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"(row, index) in this.filteredpurchaserecord\" :key=\"index\">\n                <td v-html=\"row.record_number\"></td>\n                <td v-html=\"row.name\"></td>\n                <td v-html=\"row.title\"></td>\n                <td v-html=\"row.price\"></td>\n              </tr>\n            </tbody>\n          </table>\n          <input type=\"text\" placeholder=\"Filter by title or categories\" v-model=\"filter_purchase\" />\n        </div>\n        <div>\n          <!-- <button @click=\"submit_record\">Delete record</button> -->\n          <tr>{{submitted}}</tr>\n        </div>\n      </div>\n    </div>\n  </layout-div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport LayoutDiv from \"../LayoutDiv.vue\";\n\nexport default {\n  name: \"DashboardPage\",\n  components: {\n    LayoutDiv\n  },\n  data() {\n    return {\n      user: {},\n      results: [],\n      rows: [],\n      keys: [],\n      search: '',\n      filter: '',\n      submitted: '',\n      name: [],\n      purchase_record: {},\n      tracking_record : [],\n      tracking_keys: [],\n      filter_purchase: ''\n    };\n  },\n  created() {\n    this.load_book_list();\n    this.name = localStorage.getItem(\"name\");\n    this.show_purchase_record();\n  },\n  methods: {\n\n    logoutAction() {\n      localStorage.setItem(\"token\", \"\");\n      this.$router.push(\"/\");\n    },\n    load_book_list() {\n      axios\n        .get(\"http://127.0.0.1:5000/book_list\")\n        .then((r) => {\n          this.results = r.data;\n          for (var i = 0; i < r.data.length; i++) {\n            this.rows.push(i);\n          }\n          this.keys = Object.keys(this.results[0]);\n          // console.log(this.keys);\n        })\n        .catch((e) => {\n          return e;\n        });\n    },\n    submit_record() {\n      this.purchase_record.name = this.name\n      this.purchase_record.title = this.filteredRows[0].title\n      this.purchase_record.price = this.filteredRows[0].price\n      console.log(this.purchase_record)\n      axios\n        .post(\"http://127.0.0.1:5000/buy_new_book\", this.purchase_record)\n        .then((response) => {\n            console.log(response.data)\n            this.show_purchase_record();\n        })\n        .catch((error) => {\n          console.log(error);\n        });\n    },\n    show_purchase_record(){\n      var post = {'name':this.name}\n      axios\n        .post(\"http://127.0.0.1:5000/show_user_purchase_record\", post)\n        .then((response) => {\n            console.log(response.data)\n            this.tracking_record = response.data\n            this.tracking_keys = Object.keys(this.tracking_record[0]);\n            console.log(this.tracking_keys)\n        })\n        .catch((error) => {\n          console.log(error);\n        });\n    }\n\n  },\n  computed: {\n    filteredRows() {\n      return this.results.filter(row => {\n        const title = row.title.toString();\n        const categories = row.categories;\n        const authors = row.authors.toString();\n        const ratings = row.ratings;\n        const price = row.price.toString();\n        const searchTerm = this.filter;\n        return (\n          title.includes(searchTerm) || categories.includes(searchTerm) ||\n          authors.includes(searchTerm) || ratings.includes(searchTerm) ||\n          price.includes(searchTerm)\n        );\n      });\n    },\n    filteredpurchaserecord(){\n      return this.tracking_record.filter(row => {\n        const trackingname = row.name.toString();\n        const trackingtitle = row.title.toString();\n        const trackingsearchTerm = this.filter_purchase;\n        return (\n          trackingtitle.includes(trackingsearchTerm) || trackingname.includes(trackingsearchTerm)\n        );\n      });\n    }\n  }\n}\n\n</script>\n\n<style scoped>\ntable {\n  font-family: arial, sans-serif;\n  border-collapse: collapse;\n  width: 100%;\n}\n\ntd,\nth {\n  border: 1px solid #dddddd;\n  text-align: left;\n  padding: 8px;\n}\n\nth {\n  background-color: #dddddd;\n}\n\ninput[type=text],\nselect {\n  width: 100%;\n  padding: 12px 20px;\n  margin: 8px 0;\n  display: inline-block;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  box-sizing: border-box;\n  margin-top: 25px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}